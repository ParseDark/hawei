{"componentChunkName":"component---src-templates-blog-post-js","path":"/md/typescript/小册学习/9.类型断言与类型守卫/","result":{"data":{"markdownRemark":{"html":"<h1>类型断言</h1>\n<h3>类型断言解决了什么问题</h3>\n<pre><code class=\"language-ts\">const person = {};\n\nperson.name = 'xiaomuzhu'; // Error: 'name' 属性不存在于 ‘{}’\nperson.age = 20; // Error: 'age' 属性不存在于 ‘{}’\n</code></pre>\n<p>在js写这代码没问题，但是在ts下，则会报错.</p>\n<p>所以我们需要在初始化person的时候，去给person进行断言，告诉ts变量信息.</p>\n<pre><code class=\"language-ts\">interface Person {\n  name: string;\n  age: number;\n}\n\nconst person = {} as Person;\n\nperson.name = 'xiaomuzhu';\nperson.age = 20;\n</code></pre>\n<h3>双重断言</h3>\n<pre><code class=\"language-ts\">interface Person {\n    name: string;\n    age: number;\n}\n\nconst person = 'xiaomuzhu' as Person; // Error\n</code></pre>\n<p>很显然，由于ts的机制，我们不可以把一个string作为person的接口类型的实例，所以， 我们可以使用双重断言.</p>\n<pre><code class=\"language-ts\">interface Person {\n    name: string;\n    age: number;\n}\n\nconst person = 'xiaomuzhu' as any as Person; // ok\n</code></pre>\n<p>但是不要滥用.（这里也表明，any是任何type的子类）</p>\n<h3>类型守卫</h3>\n<p>类型守卫说白了就是缩小类型的范围，我们看几个例子就容易理解了。</p>\n<ol>\n<li>instanceof 这个原生的方法</li>\n<li>in\nx in y 表示 x 属性在 y 中存在。</li>\n</ol>\n<pre><code class=\"language-ts\">class Person {\n    name = 'xiaomuzhu';\n    age = 20;\n}\n\nclass Animal {\n    name = 'petty';\n    color = 'pink';\n}\n\nfunction getSometing(arg: Person | Animal) {\n    if ('age' in arg) {\n        console.log(arg.color); // Error\n        console.log(arg.age); // ok\n    }\n    if ('color' in arg) {\n        console.log(arg.age); // Error\n        console.log(arg.color); // ok\n    }\n}\n</code></pre>\n<h3>字面量守卫</h3>\n<pre><code class=\"language-ts\">type Foo = {\n  kind: 'foo'; // 字面量类型\n  foo: number;\n};\n\ntype Bar = {\n  kind: 'bar'; // 字面量类型\n  bar: number;\n};\n\nfunction doStuff(arg: Foo | Bar) {\n  if (arg.kind === 'foo') {\n    console.log(arg.foo); // ok\n    console.log(arg.bar); // Error\n  } else {\n    console.log(arg.foo); // Error\n    console.log(arg.bar); // ok\n  }\n}\n</code></pre>","frontmatter":{"title":""}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/md/typescript/小册学习/9.类型断言与类型守卫/"}}}